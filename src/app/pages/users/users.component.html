<div class="users-container">
  <!-- Animaci√≥n de fondo (Nubes - Izquierda) -->
  <div class="animation-background">
    <ng-lottie [options]="cloudsOptions" width="100%" height="100%">
    </ng-lottie>
  </div>

  <!-- Animaci√≥n de fondo (Nubes - Derecha) -->
  <div class="animation-background2">
    <ng-lottie [options]="cloudsOptions" width="100%" height="100%">
    </ng-lottie>
  </div>

  <!-- Animaci√≥n principal (Luna o lo que sea) -->
  <div class="animation-container">
    <ng-lottie [options]="lottieOptions" width="100%" height="100%">
    </ng-lottie>
  </div>

  <!-- Contenedor principal con scroll -->
  <div class="users-list-container">
    <!-- Lista de usuarios con scroll interno -->
    <div class="users-list">
      <div
        *ngFor="let user of users"
        class="user-card"
        [class.selected]="user === selectedUser"
        (click)="selectUser(user)"
      >
        <!-- Fila principal (Avatar, Nombre y Estado) -->
        <div class="user-info">
          <div class="avatar" [ngStyle]="{ background: user.avatarColor }">
            {{ getInitials(user.name) }}
          </div>

          <p class="user-name">{{ user.name }} {{ user.lastname }}</p>

          <p
            class="user-status"
            *ngIf="user.rol !== 'admin'"
            [ngClass]="user.active ? 'active' : 'inactive'"
            (click)="toggleUserStatus(user)"
          >
            {{ user.active ? "Activo" : "Inactivo" }}
          </p>

          <!-- ‚úÖ Si el usuario es Admin, mostrar candado -->
          <p
            class="admin-status"
            *ngIf="user.rol != 'user'"
            (click)="showAdminToast()"
          >
            <i class="bi bi-lock-fill"></i>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL DE BOOTSTRAP -->
  <div
    class="modal fade"
    id="createUserModal"
    tabindex="-1"
    aria-labelledby="createUserModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <!-- ‚úÖ Centrado y tama√±o adaptable -->
      <div class="modal-content">
        <!-- Encabezado del Modal -->
        <div class="modal-header">
          <h5 class="modal-title" id="createUserModalLabel">
            Crear nuevo usuario
          </h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Cerrar"
          ></button>
        </div>

        <!-- Cuerpo del Modal -->
        <div class="modal-body">
          <div class="mb-3">
            <!-- ‚úÖ Espaciado entre elementos -->
            <label for="name" class="form-label">Nombre</label>
            <input
              type="text"
              class="form-control"
              id="name"
              [(ngModel)]="newUser.name"
              placeholder="Ingresa el nombre"
            />
          </div>

          <div class="mb-3">
            <!-- ‚úÖ Espaciado entre elementos -->
            <label for="lastname" class="form-label">Apellido</label>
            <input
              type="text"
              class="form-control"
              id="lastname"
              [(ngModel)]="newUser.lastname"
              placeholder="Ingresa el apellido"
            />
          </div>

          <div class="mb-3">
            <!-- ‚úÖ Espaciado entre elementos -->
            <label for="email" class="form-label">Correo electr√≥nico</label>
            <input
              type="email"
              class="form-control"
              id="email"
              [(ngModel)]="newUser.email"
              placeholder="Ingresa el correo"
            />
          </div>

          <div class="mb-3">
            <!-- ‚úÖ Espaciado entre elementos -->
            <label for="password" class="form-label">Contrase√±a</label>
            <input
              type="password"
              class="form-control"
              id="password"
              [(ngModel)]="newUser.password"
              placeholder="Ingresa la contrase√±a"
            />
          </div>
        </div>

        <!-- Pie del Modal -->
        <div class="modal-footer d-flex justify-content-between">
          <!-- ‚úÖ Mejor distribuci√≥n -->
          <button type="button" class="cancel-btn" data-bs-dismiss="modal">
            Cancelar
          </button>
          <button
            type="button"
            class="btn btn-success"
            (click)="createUser()"
            [disabled]="loading"
          >
            {{ loading ? "Creando..." : "Crear Usuario" }}
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- üü¶ PANEL DE DETALLES DEL USUARIO -->
  <div class="user-details" *ngIf="selectedUser">
    <h2>Detalles del usuario</h2>
    <div class="divider"></div>
    <!-- L√≠nea divisoria -->

    <!-- ‚úÖ Formulario con datos del usuario -->
    <div class="mb-3">
      <label for="name" class="form-label">Nombre</label>
      <input
        type="text"
        class="form-control"
        id="name"
        [(ngModel)]="selectedUser.name"
      />
    </div>

    <div class="mb-3">
      <label for="lastname" class="form-label">Apellido</label>
      <input
        type="text"
        class="form-control"
        id="lastname"
        [(ngModel)]="selectedUser.lastname"
      />
    </div>

    <div class="mb-3">
      <label for="email" class="form-label">Correo electr√≥nico</label>
      <input
        type="email"
        class="form-control"
        id="email"
        [(ngModel)]="selectedUser.email"
      />
    </div>

    <!-- üîπ Botones -->
    <div class="button-group" *ngIf="selectedUser?.rol !== 'admin'">
      <button class="btn btn-warning" (click)="updateUser()">Actualizar</button>
      <button class="btn btn-danger" (click)="deleteUser(selectedUser._id)">
        Eliminar
      </button>
    </div>
  </div>

  <!-- Bot√≥n para abrir el modal -->

  <button
    class="create-user-container"
    data-bs-toggle="modal"
    data-bs-target="#createUserModal"
  >
    + Crear Usuario
  </button>

  <!-- üîπ Bot√≥n de Cerrar Sesi√≥n -->
  <button class="logout-btn" (click)="logout()">
    <i class="bi bi-box-arrow-right"></i> Cerrar Sesi√≥n
  </button>
</div>
